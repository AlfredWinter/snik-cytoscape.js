<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>SNIK Ontology Graph</title>
	<script src="js/cytoscape.js"></script>
	<script src="js/snik.js"></script>
	<script src="js/style.js"></script>
	<script src="js/jquery-3.1.0.min.js"></script>
	<script src="js/cytoscape-cxtmenu.js"></script>
	<script src="js/menu.js"></script>
	<script src="js/invert.js"></script>
	<script>
		const MODIFIED = "2016-11-07";
		const ONTOLOGY_MODIFIED = "2016-10-04";
		const SPARQL_ENDPOINT = "http://www.snik.eu/sparql";
		const SPARQL_GRAPH = "http://www.snik.eu/ontology";
		const SPARQL_PREFIX = "http://www.snik.eu/ontology/";//problem: different prefixes for different partial ontologies
		const SPARQL_LIMIT = 100;
	</script>
	<script src="js/graph.js"></script>
	<script src="js/browsercheck.js"></script>
	<link rel="stylesheet" type="text/css" href="css/style.css" media="screen" />
	<link rel="stylesheet" type="text/css" href="css/overlay.css" media="screen" />
</head>

<body>
	<noscript><h1>JavaScript is off. <a href="http://enable-javascript.com/">Please enable</a> to view site.</h2></noscript>
	<script>browsercheck();</script>
<div id="top">
	<ul class="dropdown">
		<li><a href="http://www.snik.eu/sparql" target="_blank">SPARQL</a></li>
		<li><a href="http://linkedspending.aksw.org/snik" target="_blank">Browse</a></li>
		<li class="dropdown">
			<a href="javascript:void(0)" class="dropbtn" onclick="helpMenu()">Help</a>
			<div class="dropdown-content" id="help">
				<a href="manual.html" target="_blank">Manual</a>
				<a href="troubleshooting.html" target="_blank">Troubleshooting</a>
				<a href="contribute.html" target="_blank">Contribute</a>
				<a href="http://www.snik.eu/" target="_blank">Project Homepage</a>
				<a href="javascript:about()">About SNIK Graph</a>
				<a href="https://bitbucket.org/imise/snik-ontology/issues/new" target="_blank">Submit Feedback about the Ontology</a>
				<!--<a href="https://github.com/IMISE/snik-ontology/issues" target="_blank">Submit Feedback about the Ontology</a>-->
				<a href="https://github.com/IMISE/snik-cytoscape.js/issues" target="_blank">Submit Feedback about the Visualization</a>
			</div>
		</li>
		<li class="dropdown">
			<a href="javascript:void(0)" class="dropbtn" onclick="filterMenu()">Filter</a>
			<div class="dropdown-content" id="filter">
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="node[source_original='http://www.snik.eu/ontology/bb']"/>BB</span>
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="node[source_original='http://www.snik.eu/ontology/meta']"/>meta</span>
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="node[source_original='http://www.snik.eu/ontology/ob']"/>OB</span>
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="node[source_original='http://www.snik.eu/ontology/ciox']"/>CioX</span>
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="edge[shared_interaction='http://www.w3.org/2000/01/rdf-schema#subClassOf']"/>subClassOf</span>
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="edge[interaction='closeMatch'], [interaction='broadMatch']"/>inter-ontology-relations</span>
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="edge[interaction!='closeMatch'][interaction!='broadMatch']"/>non-inter-ontology-relations</span>
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="edge[interaction='subTopClass'][interaction!='broadMatch']"/>subTopClass</span>
			</div>
		</li>
		<li class="dropdown">
			<a href="javascript:void(0)" class="dropbtn" onclick="optionsMenu()">Options</a>
			<div class="dropdown-content" id="options">
					<span><input type="checkbox" id="cumulativesearch"/>cumulative search</span>
					<span><input type="checkbox" value="false" id="daymode" onclick="invert(this.checked)"/>day mode</span>
			</div>
		</li>
	</ul>

	<form id="search">
		<input type="text" name="query" id="query" list="matches" />
	</form>

	<form>
		<span id="sourcelabel">no source</span>
		<input type="button" value="Set Source" onclick="setSource(selectedNode)" />
		<input type="button" id="centersource" value="Center Source" onclick="cy.center(pathSource)" hidden/>
		<span id="targetlabel">no target </span>
		<input type="button" value="Set Target" onclick="setTarget(selectedNode)" />
		<input type="button" id="centertarget" value="Center Target" onclick="cy.center(pathTarget);" hidden/>
		<input type="button" id="shortestpath" value="Shortest Path" onclick="showPath(pathSource,pathTarget)" hidden/>
		<input type="button" id="spiderworm" value="Spider Worm" onclick="showWorm(pathSource,pathTarget)" hidden/>
		<input type="button" id="spiderworm" value="Reset View" onclick="resetStyle()"/>
	</form>
</div>

	<script>
	var removed = {};

	//** Hide or show certain nodes or edges.**/
	function filter(checkbox)
	{
		var selector = checkbox.getAttribute("value");
		if(checkbox.checked) // selected means the elements shall be shown, undo the filter
		{
			var elements = removed[selector];
			if(elements)
			{
				removed[selector] = undefined;
				elements.restore();
			}
		}
		else // unselected checkbox, hide elements by applying filter
		{
			var elements = cy.elements(selector);
			if(elements)
			{
				// if just saving nodes, the edges would get lost
				removed[selector]=elements.union(elements.connectedEdges());
				elements.remove();
			}
		}
		// the more edges are shown, the more transparent they should be
/*			"selector": "edge[!selected]",
			"css":
			{
				"opacity": 0.5,
				"width": 2.0,*/
/*	 for(var i=0; i<document.styleSheets.length; i++)
	 {
	    var sheet = document.styleSheets[i];
	  	console.log(sheet);
	  }*/
		// we overwrite js/style.js which is not listed, thus we just take any one of the .css style sheets
		// sheet = document.styleSheets[0];
		// set to maximum opaqueness for testing
		// something is wrong here
		//sheet.insertRule("edge[!selected] { opacity:1.0;}", 0);
		//console.log(cy.elements().edges().size());
	}
	</script>

	<div id="overlay" class="overlay">
		<h2 id="h2:searchresults">Search Results</h2>
		<a href="javascript:void(0)" class="closebtn" onclick="hideSearchResults()">&times;</a>
		<table id="tab:searchresults"></table>
	</div>

	<script src="js/search.js"></script>

	<div id="cy" style="width:100%;height:100vh;background-color:black;"></div>

	<script>initGraph(document.getElementById('cy'));</script>
</body>
</html>
