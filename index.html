<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>SNIK Ontology Graph</title>
	<script src="js/cytoscape.js"></script>
	<script src="js/blueorange.js"></script>
	<script src="js/style.js"></script>
	<script src="js/jquery-3.1.0.min.js"></script>
	<script src="js/cytoscape-cxtmenu.js"></script>
	<script src="js/menu.js"></script>
	<script>
		const MODIFIED = "2016-08-16";
		const ONTOLOGY_MODIFIED = "2016-07-13";
		const ENDPOINT = "http://linkedspending.aksw.org/sparql";
		const GRAPH = "http://www.imise.uni-leipzig.de/snik.owl";
	</script>
	<script src="js/graph.js"></script>
	<link rel="stylesheet" type="text/css" href="style.css" media="screen" />
</head>

<body>
	<div id="top">
		<ul>
			<li><a href="http://www.snik.eu/sparql" target="_blank">SPARQL</a></li>
			<li><a href="http://linkedspending.aksw.org/snik" target="_blank">Browse</a></li>
			<li class="dropdown">
				<a href="javascript:void(0)" class="dropbtn" onclick="help()">Help</a>
				<div class="dropdown-content" id="help">
					<a href="help.html" target="_blank">SNIK Graph Help</a>
					<a href="http://www.snik.eu/" target="_blank">Project Homepage</a>
					<a href="https://bitbucket.org/imise/snik-ontology/issues" target="_blank">Submit Feedback</a>
					<a href="javascript:about()">About SNIK Graph</a>
				</div>
			</li>
		</ul>
		<form id="search">
			<input type="text" name="query" id="query" list="matches" />
		</form>
	</div>

	<div id="cy" style="width:100%;height:100vh;background-color:black;"></div>
	<script>
		initGraph(document.getElementById('cy'));
		$('#search').submit(function()
		{
			// prevent invalid SPARQL query, make sure by just keeping basic characters
			var input = document.getElementById('query').value.replace('/[^A-Za-z 0-9]/g', '');
			console.log(input);
			var sparql = 'select ?s ?l {{?s a owl:Class.} UNION {?s a rdf:Property.} ?s rdfs:label ?l. ?l <bif:contains> "' + input + '".} limit 11';
			var http = ENDPOINT +
				'?default-graph-uri=' + encodeURIComponent(GRAPH) +
				'&query=' + escape(sparql) +
				'&format=json';

			$.getJSON(http, function(data)
			{
				console.log(data.results.bindings.length);
				console.log(data);
			}).fail(function(jqXHR, textStatus, errorThrown)
			{
				alert('getJSON request failed! ' + textStatus);
			});
			return false;
		});
</script>
</body>
</html>