<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>SNIK Ontology Graph</title>
	<script src="js/cytoscape.js"></script>
	<script src="js/blueorange.js"></script>
	<script src="js/style.js"></script>
	<script src="js/jquery-3.1.0.min.js"></script>
	<script src="js/cytoscape-cxtmenu.js"></script>
	<script src="js/menu.js"></script>
	<script>
		const MODIFIED = "2016-08-17";
		const ONTOLOGY_MODIFIED = "2016-07-13";
		const SPARQL_ENDPOINT = "http://www.snik.eu/sparql";
		const SPARQL_GRAPH = "http://www.imise.uni-leipzig.de/snik.owl";
		const SPARQL_PREFIX = "http://www.imise.uni-leipzig.de/snik.owl#";
		const SPARQL_LIMIT = 100;
	</script>
	<script src="js/graph.js"></script>
	<link rel="stylesheet" type="text/css" href="css/style.css" media="screen" />
	<link rel="stylesheet" type="text/css" href="css/overlay.css" media="screen" />
</head>

<body>
	<noscript><h1>JavaScript is off. <a href="http://enable-javascript.com/">Please enable</a> to view site.</h2></noscript>
	<script>
	// browser version checking
	// very imprecise, just to cover the majority of cases
	navigator.sayswho= (function(){
	    var ua= navigator.userAgent, tem,
	    M= ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
	    if(/trident/i.test(M[1])){
	        tem=  /\brv[ :]+(\d+)/g.exec(ua) || [];
	        return {name:'IE',version:(tem[1] || '')};
	    }
	    if(M[1]=== 'Chrome'){
	        tem= ua.match(/\b(OPR|Edge)\/(\d+)/);
	        if(tem!= null) return {name:tem[1].replace('OPR', 'Opera'),version:tem[2]};
	    }
	    M= M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
	    if((tem= ua.match(/version\/(\d+)/i))!= null) M.splice(1, 1, tem[1]);
	    return {name:M[0],version:M[1]};
	})();
	if
	(
		(navigator.sayswho == 'Firefox'&&navigator.sayswho.version<48)||
		(navigator.sayswho == 'Internet Explorer')||
		(navigator.sayswho == 'Chrome'&&navigator.sayswho.version<52)
	)
		{alert("Your browser is outdated, please update it. Graph may not work properly.");}
	</script>
<div id="top">
	<ul class="dropdown">
		<li><a href="http://www.snik.eu/sparql" target="_blank">SPARQL</a></li>
		<li><a href="http://linkedspending.aksw.org/snik" target="_blank">Browse</a></li>
		<li class="dropdown">
			<a href="javascript:void(0)" class="dropbtn" onclick="helpMenu()">Help</a>
			<div class="dropdown-content" id="help">
				<a href="manual.html" target="_blank">Manual</a>
				<a href="troubleshooting.html" target="_blank">Troubleshooting</a>
				<a href="contribute.html" target="_blank">Contribute</a>
				<a href="http://www.snik.eu/" target="_blank">Project Homepage</a>
				<a href="javascript:about()">About SNIK Graph</a>
				<a href="https://github.com/IMISE/snik-ontology/issues" target="_blank">Submit Feedback about the Ontology</a>
				<a href="https://github.com/IMISE/snik-cytoscape.js/issues" target="_blank">Submit Feedback about the Visualization</a>
			</div>
		</li>
		<li class="dropdown">
			<a href="javascript:void(0)" class="dropbtn" onclick="filterMenu()">Filter</a>
			<div class="dropdown-content" id="filter">
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="node[Sources='meta']" /> meta</span>
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="node[Sources='bb']" /> BB</span>
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="node[Sources='ob']" /> OB</span>
					<!--<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="node[Sources='ciox']"/>	CioX</span>-->
					<span><input type="checkbox" class="filterbox" onclick="filter(this)" checked value="edge[interaction='subClassOf']" /> subClassOf</span>
			</div>
		</li>
		<li class="dropdown">
			<a href="javascript:void(0)" class="dropbtn" onclick="optionsMenu()">Options</a>
			<div class="dropdown-content" id="options">
					<span><input type="checkbox" id="cumulativesearch"/>cumulative search</span>
			</div>
		</li>
	</ul>

	<form id="search">
		<input type="text" name="query" id="query" list="matches" />
	</form>

	<form>
		<span id="sourcelabel">no source</span>
		<input type="button" value="Set Source" onclick="setSource(selectedNode)" />
		<input type="button" id="centersource" value="Center Source" onclick="cy.center(pathSource)" hidden/>
		<span id="targetlabel">no target </span>
		<input type="button" value="Set Target" onclick="setTarget(selectedNode)" />
		<input type="button" id="centertarget" value="Center Target" onclick="cy.center(pathTarget);" hidden/>
		<input type="button" id="shortestpath" value="Shortest Path" onclick="showPath(pathSource,pathTarget)" hidden/>
		<input type="button" id="spiderworm" value="Spider Worm" onclick="showWorm(pathSource,pathTarget)" hidden/>
		<input type="button" id="spiderworm" value="Reset View" onclick="resetStyle()"/>
	</form>
</div>

	<script>
	var removed = {};

	function filter(checkbox)
	{
		var selector = checkbox.getAttribute("value");
		//console.log(selector);
		if(checkbox.checked)
		{
			var elements = removed[selector];
			if(elements)
			{
				removed[selector] = undefined;
				elements.restore();
			}
		}
		else
		{
			var elements = cy.elements(selector);
			if(elements)
			{
				// if just saving nodes, then the edges get lost
				removed[selector]=elements.union(elements.connectedEdges());
				elements.remove();
			}
		}
	}
	</script>

	<div id="overlay" class="overlay">
		<h2 id="h2:searchresults">Search Results</h2>
		<a href="javascript:void(0)" class="closebtn" onclick="hideSearchResults()">&times;</a>
		<table id="tab:searchresults"></table>
	</div>

	<script src="js/search.js"></script>

	<div id="cy" style="width:100%;height:100vh;background-color:black;"></div>

	<script>initGraph(document.getElementById('cy'));</script>
</body>
</html>
