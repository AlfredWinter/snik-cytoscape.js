<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>contextmenu.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-filter-Filter.html">Filter</a><ul class='methods'><li data-type='method'><a href="module-filter-Filter.html#setVisibility">setVisibility</a></li></ul></li><li><a href="module-property.Property.html">Property</a></li></ul><h3>Modules</h3><ul><li><a href="module-about.html">about</a></li><li><a href="module-button.html">button</a></li><li><a href="module-classuse.html">classuse</a><ul class='methods'><li data-type='method'><a href="module-classuse.html#~roleUse">roleUse</a></li></ul></li><li><a href="module-colorschemeday.html">colorschemeday</a></li><li><a href="module-contextmenu.html">contextmenu</a><ul class='methods'><li data-type='method'><a href="module-contextmenu.html#~registerMenu">registerMenu</a></li></ul></li><li><a href="module-download.html">download</a><ul class='methods'><li data-type='method'><a href="module-download.html#.downloadGraph">downloadGraph</a></li><li data-type='method'><a href="module-download.html#.downloadLayout">downloadLayout</a></li><li data-type='method'><a href="module-download.html#.downloadPng">downloadPng</a></li><li data-type='method'><a href="module-download.html#.downloadVisibleGraph">downloadVisibleGraph</a></li></ul></li><li><a href="module-file.html">file</a><ul class='methods'><li data-type='method'><a href="module-file.html#.addFileLoadEntries">addFileLoadEntries</a></li><li data-type='method'><a href="module-file.html#.loadGraph">loadGraph</a></li><li data-type='method'><a href="module-file.html#.loadLayout">loadLayout</a></li><li data-type='method'><a href="module-file.html#.readTextFile">readTextFile</a></li><li data-type='method'><a href="module-file.html#~addLoadEntry">addLoadEntry</a></li><li data-type='method'><a href="module-file.html#~uploadJson">uploadJson</a></li></ul></li><li><a href="module-filter.html">filter</a><ul class='methods'><li data-type='method'><a href="module-filter.html#~addFilterEntries">addFilterEntries</a></li></ul></li><li><a href="module-graph.html">graph</a><ul class='methods'><li data-type='method'><a href="module-graph.html#~getSource">getSource</a></li><li data-type='method'><a href="module-graph.html#~hideNodes">hideNodes</a></li><li data-type='method'><a href="module-graph.html#~highlightEdges">highlightEdges</a></li><li data-type='method'><a href="module-graph.html#~highlightNodes">highlightNodes</a></li><li data-type='method'><a href="module-graph.html#~initGraph">initGraph</a></li><li data-type='method'><a href="module-graph.html#~invert">invert</a></li><li data-type='method'><a href="module-graph.html#~resetStyle">resetStyle</a></li><li data-type='method'><a href="module-graph.html#~setSelectedNode">setSelectedNode</a></li><li data-type='method'><a href="module-graph.html#~setSource">setSource</a></li><li data-type='method'><a href="module-graph.html#~setStarMode">setStarMode</a></li><li data-type='method'><a href="module-graph.html#~setTarget">setTarget</a></li><li data-type='method'><a href="module-graph.html#~showDoubleStar">showDoubleStar</a></li><li data-type='method'><a href="module-graph.html#~showNodes">showNodes</a></li><li data-type='method'><a href="module-graph.html#~showPath">showPath</a></li><li data-type='method'><a href="module-graph.html#~showStar">showStar</a></li><li data-type='method'><a href="module-graph.html#~showStarPath">showStarPath</a></li><li data-type='method'><a href="module-graph.html#~showWorm">showWorm</a></li></ul></li><li><a href="module-layout.html">layout</a><ul class='methods'><li data-type='method'><a href="module-layout.html#.positions">positions</a></li><li data-type='method'><a href="module-layout.html#.presetLayout">presetLayout</a></li><li data-type='method'><a href="module-layout.html#.run">run</a></li><li data-type='method'><a href="module-layout.html#.runCached">runCached</a></li><li data-type='method'><a href="module-layout.html#~storageName">storageName</a></li></ul></li><li><a href="module-loadGraphFromSparql.html">loadGraphFromSparql</a></li><li><a href="module-log.html">log</a><ul class='methods'><li data-type='method'><a href="module-log.html#.debug">debug</a></li><li data-type='method'><a href="module-log.html#.error">error</a></li><li data-type='method'><a href="module-log.html#.info">info</a></li><li data-type='method'><a href="module-log.html#.trace">trace</a></li><li data-type='method'><a href="module-log.html#.warn">warn</a></li></ul></li><li><a href="module-lunr.html">lunr</a></li><li><a href="module-main.html">main</a></li><li><a href="module-menu.html">menu</a><ul class='methods'><li data-type='method'><a href="module-menu.html#~addLoadEntries">addLoadEntries</a></li></ul></li><li><a href="module-progress.html">progress</a><ul class='methods'><li data-type='method'><a href="module-progress.html#~progress">progress</a></li></ul></li><li><a href="module-property.html">property</a><ul class='methods'><li data-type='method'><a href="module-property.html#.possible">possible</a></li></ul></li><li><a href="module-rdf.html">rdf</a><ul class='methods'><li data-type='method'><a href="module-rdf.html#.sub">sub</a></li></ul></li><li><a href="module-rdfGraph.html">rdfGraph</a></li><li><a href="module-search.html">search</a><ul class='methods'><li data-type='method'><a href="module-search.html#.search">search</a></li><li data-type='method'><a href="module-search.html#~showSearch">showSearch</a></li></ul></li><li><a href="module-sparql.html">sparql</a><ul class='methods'><li data-type='method'><a href="module-sparql.html#.ask">ask</a></li><li data-type='method'><a href="module-sparql.html#.sparql">sparql</a></li></ul></li><li><a href="module-string.html">string</a><ul class='methods'><li data-type='method'><a href="module-string.html#.abbrv">abbrv</a></li></ul></li><li><a href="module-style.html">style</a></li><li><a href="module-timer.html">timer</a></li></ul><h3>Global</h3><ul><li><a href="global.html#browsercheck">browsercheck</a></li><li><a href="global.html#colorschemenight">colorschemenight</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">contextmenu.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
Creates the circular context menu that can be opened on top of a node.
@module */
import {ONTOLOGY_ISSUE_WARNING} from "./about.js";
import {roleUse} from "./classuse.js";
import * as graph from "./graph.js";
import * as sparql from "./sparql.js";
import * as rdf from "./rdf.js";
import * as log from "./log.js";
import * as string from "./string.js";
import * as property from "./property.js";

const defaultsNodes = {
  menuRadius: 220, // the radius of the circular menu in pixels
  selector: 'node[st!="Role"]', // elements matching this Cytoscape.js selector will trigger cxtmenus
  commands: [
    {
      content: 'ticket',
      select: node=>
      {
        //var b = confirm("Please only use this ticket tracker for problems with the ontology data, not the javascript visualization web application. Continue?");
        //window.open("https://github.com/IMISE/snik-ontology/issues/new");
        //if(b)
        {
          //window.open("https://bitbucket.org/imise/snik-ontology/issues/new?title="+
          if(confirm(ONTOLOGY_ISSUE_WARNING))
          {
            var url = 'https://github.com/IMISE/snik-ontology/issues/new?title='+
            encodeURIComponent(node._private.data.name)+' v'+
            '&amp;body='+encodeURIComponent('The class '+node._private.data.name+
            ' has [incorrect/missing attribute values | incorrect/missing relations to other classes, other (please specify and remove not applicable ones).]\n\n**Details**\n');
            window.open(url);
          }
        }
      },
    },
    /*    {
    content: 'set as path target',
    select: node=>
    {
    graph.setTarget(node);
  }
},*/
    {
      content: 'set as path source',
      select: node=>
      {
        graph.setSource(node);
      },
    },
    {
      content: 'edit',
      select: node=>
      {
        window.open('https://www.snik.eu/ontowiki/view/?r='+node._private.data.name+"&amp;m="+rdf.sub(node._private.data.name));
      },
    },
    {
      content: 'LodLive',
      select: node=>
      {
        window.open('http://en.lodlive.it/?'+node._private.data.name);
      },
    },
    {
      content: 'description',
      //select: node=> {window.open(node._private.data.name);}
      select: node=>
      {
        window.open(node._private.data.name);
      },
    },
    {
      content: 'star',
      select: node=>
      {
        graph.showStar(node);
      },
    },
    {
      content: 'path',
      select: node=>
      {
        if(graph.getSource()&amp;&amp;graph.getSource()!==node)
        {
          graph.showPath(graph.getSource(), node);
        }
      },
    },
    {
      content: 'spiderworm',
      select: node=>
      {
        if(graph.getSource()&amp;&amp;graph.getSource()!==node)
        {
          graph.showWorm(graph.getSource(), node);
        }
      },
    },
    {
      content: 'doublestar',
      select: node=>
      {
        if(graph.getSource()&amp;&amp;graph.getSource()!==node)
        {
          graph.showDoubleStar(graph.getSource(), node);
        }
      },
    },
    {
      content: 'starpath',
      select: node=>
      {
        if(graph.getSource()&amp;&amp;graph.getSource()!==node)
        {
          graph.showStarPath(graph.getSource(), node);
        }
      },
    },
    /*
{
content: 'add connection',
select: target=>
{
const source = graph.getSource();
if(source&amp;&amp;(source!==target))
{
const properties = property.possible(source,target);
if(properties.length===0)
{
log.error(`no possible properties between ${rdf.short(source.data().name)} and ${rdf.short(target.data().name)}`);
return false;
}
var box = dhtmlx.modalbox({
title:`Create Connection between ${string.abbrv(rdf.short(source.data().name))} and ${string.abbrv(rdf.short(target.data().name))}`,
text:`&lt;form id="connectionform">&lt;select id="connectionselect">
${properties.map((p)=>`&lt;option value="${p.uri}">${p.label}&lt;/option>`)}
&lt;/select>
&lt;input type='submit' value='Create' style='width:250px;'>
&lt;input type='button' id="hidebox" value='Cancel' style='width:250px;'>
`,
width:"250px",
});
document.getElementById("hidebox").addEventListener("click",()=>{dhtmlx.modalbox.hide(box);});
const form = document.getElementById("connectionform");
form.addEventListener("submit",event=>
{
event.preventDefault();
dhtmlx.modalbox.hide(box);
const select=form.querySelector("#connectionselect");
sparql.addTriple(graph.getSource().data().name,select.options[select.selectedIndex].value,target.data().name,"http://www.snik.eu/ontology/test");
graph.cy.add(
{
group: "edges",
data: {
source: graph.getSource().data().name,
target: target.data().name,
pl: "isAssociatedWith",
},
});
});
}
},
},
{
content: 'add instance',
select: node=>
{
var box = dhtmlx.modalbox({
title:"Create Instance of Class "+string.abbrv(rdf.short(node.data().name),25),//+rdf.short(node.data().name)
text:`&lt;form type="messageform" id='instanceform'>
&lt;div>&lt;label>URI Suffix in CamelCase   &lt;input class='inform' id="suffix" type='text' minlength="3" pattern="([A-Z][a-z0-9]+)+">&lt;/label>&lt;/div>
&lt;div>&lt;label>English Label             &lt;input class='inform' id="le" type='text' minlength="3" pattern="[A-Za-z0-9., ]+">&lt;/label>&lt;/div>
&lt;div>&lt;label>German Label              &lt;input class='inform' id="ld" type='text' minlength="3" pattern="[A-Za-zöäüÖÄÜß0-9., ]+">&lt;/label>&lt;/div>
&lt;input type='submit' value='Create' style='width:250px;'>
&lt;input type='button' id="hidebox" value='Cancel' style='width:250px;'>
&lt;/form>`,
width:"250px",
});
document.getElementById("hidebox").addEventListener("click",()=>{dhtmlx.modalbox.hide(box);});
const form = document.getElementById("instanceform");
form.addEventListener("submit",event=>
{
event.preventDefault();
const suffix=form.querySelector("#suffix").value;
const le=form.querySelector("#le").value;
const ld=form.querySelector("#ld").value;
const uri= rdf.long(node.data().prefix+":"+suffix);
if(!uri.startsWith("http://www.snik.eu/ontology/")) {throw "Invalid URI: "+uri;}

sparql.addTriple(uri,rdf.long("rdf:type"),node.data().name,"http://www.snik.eu/ontology/test");
sparql.addLabel(uri,ld,"de","http://www.snik.eu/ontology/test");
sparql.addLabel(uri,le,"en","http://www.snik.eu/ontology/test");

dhtmlx.modalbox.hide(box);
}
);
},
},*/
    /* commented out until denethor pdf links in browser work
{
content: 'book page (in development)',
select: functiocxttn(node)
{
var page = node.data()['Definition_DE_Pages'][0];
if(!page) {page = node.data()['Definition_EN_Pages'][0];}
var source = node.data().Sources;
if(!page || !(source === 'bb' || source === 'ob'))
{
alert("no book page defined");
return;
}
switch(source)
{
case 'bb':
window.open("https://denethor.imise.uni-leipzig.de/remote.php/webdav/Shared/SNIK/bb.pdf#page="+page,"_blank");
break;

case 'ob':
window.open("https://denethor.imise.uni-leipzig.de/remote.php/webdav/Shared/SNIK/ob.pdf#page="+page,"_blank");
break;
}
}
}
*/
  ],
  fillColor: 'rgba(200, 200, 200, 0.95)', // the background colour of the menu
  activeFillColor: 'rgba(150, 0, 0, 1)', // the colour used to indicate the selected command
  openMenuEvents: 'cxttapstart taphold', // cytoscape events that will open the menu (space separated)
  itemColor: 'rgba(80,0,0)', // the colour of text in the command's content
  itemTextShadowColor: 'gray', // the text shadow colour of the command's content
  zIndex: 9999, // the z-index of the ui div
};

const defaultsRelations = {
  menuRadius: 100, // the radius of the circular menu in pixels
  selector: 'edge', // elements matching this Cytoscape.js selector will trigger cxtmenus
  commands: [
    {
      content: 'ticket',
      select: function(edge)
      {
        //window.open("https://bitbucket.org/imise/snik-ontology/issues/new?title="+
        window.open
        (
          'https://github.com/IMISE/snik-ontology/issues/new?title='+
          encodeURIComponent(edge._private.data.name+' v')+
          '&amp;body='+encodeURIComponent('The edge "'+edge._private.data.name+'" is incorrect.\n\n**Details**\n')
        );
      },
    },
    {
      content: 'edit',
      select: function(edge)
      {
        window.open('https://www.snik.eu/ontowiki/view/?r='+edge._private.data.source+"&amp;m="+rdf.sub(edge._private.data.source));
      },
    },
  ],
  fillColor: 'rgba(255, 255, 50, 0.35)', // the background colour of the menu
  activeFillColor: 'rgba(255, 255, 80, 0.35)', // the colour used to indicate the selected command
  openMenuEvents: 'cxttapstart taphold', // cytoscape events that will open the menu (space separated)
  itemColor: 'white', // the colour of text in the command's content
  itemTextShadowColor: 'gray', // the text shadow colour of the command's content
  zIndex: 9999, // the z-index of the ui div
};

/** Fill the context menu and register it with configuration, which will show it for the node and edge selectors.
The extension itself is already registered through the plain HTML/JS import in index.html,
which makes available cy.cxtmenu().*/
function registerMenu()
{
  graph.cy.cxtmenu(defaultsNodes);
  defaultsNodes.selector="node[st='Role']";
  defaultsNodes.commands.push(
    {
      content: 'role use',
      select: node=>
      {
        roleUse(node.data().name);
      },
    }
  );
  graph.cy.cxtmenu(defaultsNodes);
  graph.cy.cxtmenu(defaultsRelations);
}

export {registerMenu};
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Feb 22 2018 22:23:13 GMT+0100 (CET) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
